{
  "id": "tinhte",
  "home": "https://tinhte.vn",
  "pages": [
    {
      "name": "list",
      "patterns": [
        "^https://tinhte.vn/?$"
      ],
      "example": "https://tinhte.vn",
      "parser": {
        "script": {
          "parse_promoted": [
            {
              "func": "filter",
              "params": {
                "func": "==",
                "params": {
                  "exp1": "${value._req.uri}",
                  "exp2": "threads/promoted"
                }
              }
            },
            {
              "func": "map",
              "params": "get(path=value.threads)"
            },
            "flatten()",
            {
              "func": "map",
              "params": "script(name=convert_thread)"
            }
          ],
          "convert_thread": [
            {
              "func": "pick",
              "params": {
                "fields": {
                  "title": [
                    "get(path=value.thread_title)"
                  ],
                  "url": [
                    "get(path=value.links.permalink)"
                  ],
                  "image": [
                    "get(path=value.thread_image.link)"
                  ],
                  "created_at": [
                    "get(path=value.thread_create_date)",
                    "date1000"
                  ],
                  "summary": [
                    "get(path=value.first_post.post_body_plain_text)",
                    "split(glue=\n)",
                    "first()"
                  ]
                }
              }
            }
          ]
        },
        "transforms": [
          {
            "func": "nextjs_data"
          },
          "get(path=value.props.pageProps.apiData.jobs)",
          "values()",
          "script(name=parse_promoted)",
          "uniq_by_field(field=url)"
        ]
      }
    },
    {
      "name": "view",
      "patterns": [
        "^https://tinhte.vn/thread/.+\\.\\d+/?$"
      ],
      "example": "https://tinhte.vn/thread/tren-tay-rambler-14-oz-mau-nordic-blue-ly-giu-nhiet-ban-chay-nhi-cua-yeti.3669956/",
      "parser": {
        "script": {
          "convert_thread": [
            {
              "func": "pick",
              "params": {
                "fields": {
                  "title": [
                    "get(path=value.thread_title)"
                  ],
                  "url": [
                    "get(path=value.links.permalink)"
                  ],
                  "image": [
                    "get(path=value.thread_image.link)"
                  ],
                  "content": [
                    "get(path=value.posts[0].post_body_html)",
                    "html_safe()"
                  ],
                  "created_at": [
                    "get(path=value.thread_create_date)",
                    "date1000"
                  ],
                  "author": [
                    {
                      "func": "pick",
                      "params": {
                        "fields": {
                          "name": [
                            "get(path=value.creator_username)"
                          ],
                          "avatar": [
                            "get(path=value.links.first_poster_avatar)"
                          ]
                        }
                      }
                    }
                  ],
                  "comments": [
                    "get(path=value.posts)",
                    "slice(start=1)",
                    {
                      "func": "map",
                      "params": "script(name=post_to_comment)"
                    }
                  ]
                }
              }
            }
          ],
          "post_to_comment": [
            {
              "func": "pick",
              "params": {
                "fields": {
                  "content": [
                    "get(path=value.post_body_html)"
                  ],
                  "author": [
                    {
                      "func": "pick",
                      "params": {
                        "fields": {
                          "name": [
                            "get(path=value.poster_username)"
                          ],
                          "avatar": [
                            "get(path=value.links.poster_avatar)"
                          ]
                        }
                      }
                    }
                  ]
                }
              }
            }
          ]
        },
        "transforms": [
          {
            "func": "nextjs_data"
          },
          "get(path=value.props.pageProps.apiData.jobs)",
          "values()",
          {
            "func": "filter",
            "params": "==(exp1=${value._req.uri},exp2=posts)"
          },
          "get(path=value[0].thread)",
          "log(name=cache)",
          "script(name=convert_thread)"
        ]
      }
    }
  ]
}